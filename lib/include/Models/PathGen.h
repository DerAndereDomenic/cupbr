#pragma once

#include <CUNET.h>

namespace cunet
{
    class PathGen
    {
        public:
        PathGen()
        {
           float weight0[] = {-0.0769372433423996, -0.5438888072967529, -4.438626289367676, -0.13396579027175903, 1.0403822670923546e-05, 0.00018825054576154798, -3.399968409212306e-05, -8.50800788612105e-05, 0.27402886748313904, -2.6815972328186035, 5.2176032066345215, -0.34811434149742126, -0.00016316157416440547, 0.00030449280166067183, -3.719496089615859e-05, 3.503299012663774e-05, 0.2873239815235138, 2.846250057220459, -0.3389154374599457, 0.5400399565696716, 3.0088680432527326e-05, -5.846445492352359e-05, -5.1989423809573054e-05, 0.0002269058022648096, -0.05747191235423088, 1.4260870218276978, -2.1388750076293945, 0.18773265182971954, 2.8994532840442844e-05, 4.6534983994206414e-05, 0.00013580282393377274, -0.0001342404430033639, -0.07296746224164963, -1.5019558668136597, -0.2385876178741455, -0.20747244358062744, -0.00013820668391417712, -0.0002448364393785596, -1.2020886970276479e-05, -6.9525699473160785e-06, 0.3904682397842407, 2.440340995788574, 2.3297502994537354, 0.5023712515830994, 2.3775057343300432e-05, -1.5819396139704622e-05, -0.0001308997452724725, 0.00022402963077183813, -0.15854911506175995, 0.24424581229686737, -8.604595184326172, -0.005594072863459587, -3.4369029435765697e-06, -0.00011931783228646964, 3.9640577597310767e-05, -9.388447506353259e-05, 0.2878102958202362, -1.9651602506637573, 5.318033695220947, -0.22280505299568176, -6.010585821059067e-06, 6.635529280174524e-05, -0.00023246416822075844, -3.746112633962184e-05, };
           float bias0[] = {-1.2416719198226929, -0.720265805721283, -0.9711326360702515, -0.9357145428657532, -1.2763993740081787, -0.15408426523208618, 1.801146149635315, -0.3981270492076874, };
           linear2 = Linear<float>(8, 8, weight0, bias0);
           softplus3 = Softplus<float>();
           float weight2[] = {-0.3245360553264618, 0.520027756690979, 0.31677523255348206, 0.024946698918938637, -0.5293217301368713, -0.18296463787555695, -0.4943748414516449, -0.3726116120815277, 0.43606260418891907, -0.23547761142253876, 0.20086155831813812, 0.28630757331848145, 0.4690234065055847, -0.20381514728069305, -0.23021350800991058, 0.40925270318984985, 4.3146138191223145, -0.209617018699646, 0.04823035001754761, 0.7151075601577759, 4.0572919845581055, 0.03086768463253975, 1.5239813327789307, -0.12810270488262177, 1.5542103052139282, -0.4058220088481903, 0.7192266583442688, 0.8731136322021484, 2.239877462387085, 0.0833117738366127, -0.31709879636764526, -0.44389912486076355, 12.32369327545166, -0.200367271900177, -0.03466460108757019, 5.855844020843506, 8.210762023925781, 0.36300379037857056, 11.451973915100098, -0.2744271755218506, -18.954469680786133, -0.20384718477725983, -0.031012017279863358, -1.5505106449127197, -0.2814013361930847, 0.03994860500097275, -21.45301055908203, 0.1724957376718521, 0.06985439360141754, -0.2479022741317749, -0.25883176922798157, 0.46028849482536316, -0.5252164602279663, 0.6213200092315674, 0.2060331404209137, -0.3499545454978943, 2.8273799419403076, 0.007928983308374882, 0.047394007444381714, 1.8529579639434814, 1.4759681224822998, 0.02010934241116047, 3.4004523754119873, 0.0460544228553772, };
           float bias2[] = {0.07548055797815323, 0.18280047178268433, 0.1002163290977478, -0.18785133957862854, -0.3664022386074066, 0.9220203161239624, -0.11652567237615585, 0.5169183611869812, };
           linear4 = Linear<float>(8, 8, weight2, bias2);
           softplus5 = Softplus<float>();
           float weight4[] = {-0.568535327911377, -0.4288967549800873, 0.022498853504657745, -0.6274469494819641, -0.3755168914794922, -0.8336536288261414, 1.386223554611206, 1.220895767211914, 0.45521023869514465, 0.613079309463501, -0.4482196271419525, -0.014782805927097797, 0.4260650873184204, 0.4097689092159271, -0.10045089572668076, -1.1966640949249268, -0.00025295495288446546, 0.009114398621022701, -0.0038808747194707394, -0.0030027911998331547, 0.0029505935963243246, 0.003538008313626051, 0.0020360557828098536, -0.00739321717992425, 0.32414281368255615, -0.1557711362838745, -1.882678508758545, -7.863683223724365, 0.47951626777648926, -3.232658863067627, 1.6390479803085327, -0.3113001585006714, 0.1251429319381714, 0.33556464314460754, 0.8670034408569336, -2.650578498840332, -0.6633297204971313, -1.371726155281067, 1.2149369716644287, -0.45380544662475586, -0.02759646624326706, 0.022510629147291183, -0.8485925197601318, -4.228420734405518, 0.15267962217330933, -1.7032768726348877, 1.790305256843567, 0.04944068193435669, };
           float bias4[] = {-0.04423503205180168, 0.15358129143714905, -0.005072454456239939, 3.127751350402832, 0.34613966941833496, 0.6403874754905701, };
           linear6 = Linear<float>(8, 6, weight4, bias4);
        }

        __device__
        void operator()(float* input, float* output)
        {
            float temp_output0[8];
            linear2(input, temp_output0);
            float temp_output1[8];
            softplus3(temp_output0, temp_output1, 8);
            float temp_output2[8];
            linear4(temp_output1, temp_output2);
            float temp_output3[8];
            softplus5(temp_output2, temp_output3, 8);
            float temp_output4[6];
            linear6(temp_output3, output);
        }

        private:
        Linear<float> linear2;
        Softplus<float> softplus3;
        Linear<float> linear4;
        Softplus<float> softplus5;
        Linear<float> linear6;
    }; // class
} // namespace cunet