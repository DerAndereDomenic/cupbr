#pragma once

#include <CUNET.h>

namespace cunet
{
    class PathGen
    {
        public:
        PathGen()
        {
           float weight0[] = {-4.195907968096435e-05, -2.8498382568359375, -0.8585873246192932, 0.00013787129137199372, 1.9064377546310425, 5.632976535707712e-05, 0.00014484090206678957, 6.590611883439124e-05, 1.7324382497463375e-05, 1.6787269115447998, 5.098143100738525, -2.9569016987807117e-05, -0.7453767657279968, 9.54655188252218e-05, -8.37351365134964e-07, -7.39229071768932e-05, 9.768531890586019e-05, 3.3144783973693848, 0.7523031234741211, 7.356770220212638e-05, 0.02848844602704048, -0.00013529561692848802, -0.00029659614665433764, -3.1661955290474e-05, -1.0841644325410016e-05, -2.419067621231079, 6.209875106811523, 3.1561761716147885e-05, 0.13571852445602417, 1.4829892052148352e-06, 0.00017216088599525392, 2.529727316868957e-05, -2.9737189834122546e-05, -2.9772350788116455, 2.535025119781494, 5.574365786742419e-06, 0.3467276990413666, 1.2318625522311777e-05, 6.65227635181509e-05, -6.343702261801809e-05, 3.3467290450062137e-06, -1.5283081531524658, 2.0455002784729004, 7.321620068978518e-05, 0.7061551213264465, -0.00011457697110017762, 1.3405518984654918e-05, 9.515019337413833e-05, -0.00011665050260489807, -0.8534385561943054, -1.293945074081421, -9.13272742764093e-06, -0.6138207316398621, -0.000314088974846527, 2.3179547497420572e-05, 0.00010321403533453122, -9.241668885806575e-05, -0.7689937353134155, -30.900083541870117, 2.1914042008575052e-05, 0.12123269587755203, 3.441304215812124e-05, -7.296434887393843e-06, -1.0061963621410541e-05, };
           float bias0[] = {0.5963108539581299, 0.6196848750114441, -1.9701881408691406, -0.32390695810317993, -1.1781445741653442, -0.16521134972572327, -3.463231086730957, -1.4150406122207642, };
           linear2 = Linear<float>(8, 8, weight0, bias0);
           softplus3 = Softplus<float>();
           float weight2[] = {0.67830890417099, 0.15353751182556152, 0.8557118773460388, -0.8490011096000671, 0.6548131704330444, -3.099832534790039, 0.8344966769218445, 2.163243293762207, -1.106513500213623, 0.03171268850564957, 0.3558617830276489, -0.10081639885902405, 0.5197573304176331, -0.4814212918281555, 0.3752914071083069, 0.2883610427379608, 0.10145512223243713, -0.00726790726184845, -0.03425099328160286, -0.06961321830749512, 0.16185356676578522, -0.23164917528629303, 0.15775874257087708, 1.2188942432403564, 0.6696510910987854, -0.1952415257692337, 0.8018433451652527, -0.5284375548362732, 0.39166098833084106, -1.701523780822754, -0.20550978183746338, 9.625191688537598, 0.05664708465337753, -0.21331322193145752, 0.2411208152770996, 0.3442351222038269, -0.35261040925979614, -0.026437919586896896, -0.2954489588737488, -0.8483552932739258, -0.18086977303028107, -0.21862328052520752, 0.14315831661224365, 0.15561403334140778, -0.10976896435022354, -0.1207347959280014, 0.9456481337547302, 0.5895941853523254, 0.4550143778324127, -0.5525345206260681, 0.4652487635612488, -0.12612111866474152, 0.7278061509132385, -2.573885917663574, -2.291733980178833, 0.5972605347633362, -5.084015369415283, 0.5566540360450745, 0.8395220041275024, -0.8338388204574585, 0.6179235577583313, -1.9810028076171875, -0.06228918209671974, -2.0544559955596924, };
           float bias2[] = {-0.30091723799705505, 1.530740737915039, -0.33914807438850403, 0.20586948096752167, 1.3784691095352173, -0.239712193608284, -0.14220435917377472, -0.07857870310544968, };
           linear4 = Linear<float>(8, 8, weight2, bias2);
           softplus5 = Softplus<float>();
           float weight4[] = {-0.010733437724411488, 1.1077187061309814, 0.058831553906202316, -0.09376306086778641, -0.48682737350463867, -1.2103508710861206, 0.7128973603248596, -0.2542237937450409, 0.005071633029729128, 0.0009185639792121947, 0.07707028090953827, -0.01098485104739666, 0.02300984598696232, -0.013769642449915409, 0.007864587940275669, -0.0002862157125491649, -0.0007072049775160849, 6.26617984380573e-05, -0.0006113090203143656, -6.708870932925493e-05, -0.0005129603086970747, -0.001305767917074263, 0.005670039914548397, 5.5594329751329497e-05, -3.892606735229492, -1.44215726852417, -18.0340633392334, -0.03378896415233612, -4.345855236053467, 12.95758056640625, 7.855990886688232, -1.4443342685699463, -9.996623039245605, 0.37310659885406494, 4.685997486114502, -9.288894653320312, 1.2329572439193726, -4.237414836883545, 18.454425811767578, 1.4835482835769653, -6.572587966918945, -0.03482057526707649, 0.6812359094619751, -2.327249050140381, -0.32913240790367126, -1.612764596939087, 35.72169494628906, 0.02132793702185154, };
           float bias4[] = {0.2875819206237793, -0.05876115337014198, 0.0010930320713669062, 5.889203071594238, -4.471721649169922, -0.2637619376182556, };
           linear6 = Linear<float>(8, 6, weight4, bias4);
        }

        __device__
        void operator()(float* input, float* output)
        {
            float temp_output0[8];
            linear2(input, temp_output0);
            float temp_output1[8];
            softplus3(temp_output0, temp_output1, 8);
            float temp_output2[8];
            linear4(temp_output1, temp_output2);
            float temp_output3[8];
            softplus5(temp_output2, temp_output3, 8);
            float temp_output4[6];
            linear6(temp_output3, output);
        }

        private:
        Linear<float> linear2;
        Softplus<float> softplus3;
        Linear<float> linear4;
        Softplus<float> softplus5;
        Linear<float> linear6;
    }; // class
} // namespace cunet