#pragma once

#include <CUNET.h>

namespace cunet
{
    class LenGen
    {
        public:
        LenGen()
        {
           float weight0[] = {0.2782275080680847, -1.0938260555267334, -0.00028132510487921536, 0.48515528440475464, -0.025730246677994728, 0.08865035325288773, 1.2803325262211729e-05, -0.13898806273937225, -0.3478253483772278, 1.886991024017334, -5.97034850216005e-05, 0.47971591353416443, -4.152591705322266, -0.33770525455474854, 0.00013922018115408719, 2.4823849201202393, -0.050392698496580124, 0.1785942167043686, 5.009079541196115e-05, -0.2668798565864563, 3.531872034072876, -0.6412889361381531, 4.108775465283543e-05, 4.242098808288574, 0.6123027205467224, 0.9472967386245728, -0.00018784186977427453, 0.4919074475765228, 0.2701166868209839, 2.405696392059326, 1.7573973309481516e-05, 0.6921799182891846, };
           float bias0[] = {-3.5022852420806885, 1.1166590452194214, -2.8428428173065186, 0.08938824385404587, 1.8124933242797852, -2.0151679515838623, -3.007331132888794, -3.864271879196167, };
           linear2 = Linear<float>(4, 8, weight0, bias0);
           softplus3 = Softplus<float>();
           float weight2[] = {0.26850879192352295, 0.765592634677887, 0.06104956939816475, 0.0015697889029979706, -1.235711932182312, 0.015575685538351536, -0.22041355073451996, -0.024118691682815552, -0.1502399891614914, -0.1746719628572464, 0.7883236408233643, 1.0024391412734985, -0.6928532719612122, -0.7282952666282654, -1.0771034955978394, -0.40639427304267883, 0.12292297184467316, 0.10480069369077682, 0.055789947509765625, 2.7029030323028564, 1.882615566253662, -2.064887046813965, 1.3892483711242676, -0.4325404167175293, -1.2958707809448242, 1.4472734928131104, -5.314978122711182, -7.100796222686768, -3.994699001312256, 0.1334143579006195, -0.276710569858551, 0.3539039194583893, -1.1435737609863281, -0.7273421883583069, -3.879185199737549, -5.585419178009033, -1.5585507154464722, -0.22574210166931152, 1.2374153137207031, 1.3616383075714111, 0.15922267735004425, -1.402685523033142, 2.0457592010498047, -0.6183837056159973, -0.689618706703186, 0.5625385642051697, -2.141065835952759, -1.34381103515625, 0.011927337385714054, 0.38311508297920227, 0.09920062124729156, -0.16575419902801514, 0.5502947568893433, 0.11997707188129425, 0.3335881531238556, -0.1722530722618103, 0.060710735619068146, 0.802742600440979, 0.08487537503242493, 0.867428183555603, 0.5782669186592102, -0.6655911207199097, 0.6610990762710571, -0.2549094557762146, };
           float bias2[] = {1.6582880020141602, -0.0036562150344252586, -0.061028722673654556, 2.4192192554473877, -2.100785732269287, -0.28958654403686523, -0.13299345970153809, 0.13634005188941956, };
           linear4 = Linear<float>(8, 8, weight2, bias2);
           softplus5 = Softplus<float>();
           float weight4[] = {-1.0383793115615845, -0.3741070628166199, -0.02035141922533512, 0.8441881537437439, 1.4575891494750977, -0.3358219861984253, 0.13687029480934143, -0.11872302740812302, 5.198866844177246, -9.24499225616455, -15.588114738464355, 0.8527678847312927, -6.433302402496338, 1.0346759557724, -0.7246438264846802, 0.970170259475708, 0.4938024878501892, -2.3575479984283447, -1.7009371519088745, -0.4091021418571472, -7.025099277496338, 1.0453633069992065, -0.4193861186504364, -1.2185381650924683, 0.05613350495696068, 0.4977160096168518, -0.42812255024909973, -0.5388840436935425, -7.080132484436035, 0.7487366199493408, -0.33129504323005676, -0.7570905089378357, 1.7072447538375854, 0.18695402145385742, -3.8771965503692627, 0.19969432055950165, 0.7134600877761841, 0.09425177425146103, -0.09325162321329117, -0.5658910274505615, 1.3940805196762085, -1.0425938367843628, -0.6339808702468872, 0.08576814830303192, -4.2869439125061035, 0.6384084820747375, -0.34776824712753296, -2.52811861038208, -1.8624331951141357, 0.9259653687477112, 0.5639027953147888, 1.7665170431137085, 2.827598810195923, -1.4220064878463745, -0.6472351551055908, 0.43715453147888184, -0.09677130728960037, 0.07733748108148575, -0.09088710695505142, 0.016048051416873932, -0.5541689991950989, 0.04358072578907013, -0.30136939883232117, 0.4407126307487488, };
           float bias4[] = {-1.2245898246765137, 10.853509902954102, -1.4999438524246216, -0.5094051957130432, -0.20286552608013153, 0.9648057818412781, -0.5772393345832825, 0.547373354434967, };
           linear6 = Linear<float>(8, 8, weight4, bias4);
           softplus7 = Softplus<float>();
           float weight6[] = {-0.3786640167236328, 0.09188759326934814, 0.3036811649799347, -0.9314807057380676, -0.9843127131462097, 0.8848158717155457, 0.02077367529273033, -0.4113747775554657, 0.010892936028540134, -1.5085504055023193, -1.3852039575576782, -0.5767434239387512, 0.26533782482147217, 5.468020439147949, -68.72470092773438, -2.9563636779785156, };
           float bias6[] = {0.48897886276245117, 7.141066074371338, };
           linear8 = Linear<float>(8, 2, weight6, bias6);
        }

        __device__
        void operator()(float* input, float* output)
        {
            float temp_output0[8];
            linear2(input, temp_output0);
            float temp_output1[8];
            softplus3(temp_output0, temp_output1, 8);
            float temp_output2[8];
            linear4(temp_output1, temp_output2);
            float temp_output3[8];
            softplus5(temp_output2, temp_output3, 8);
            float temp_output4[8];
            linear6(temp_output3, temp_output4);
            float temp_output5[8];
            softplus7(temp_output4, temp_output5, 8);
            //float temp_output6[2];
            linear8(temp_output5, output);
        }

        private:
        Linear<float> linear2;
        Softplus<float> softplus3;
        Linear<float> linear4;
        Softplus<float> softplus5;
        Linear<float> linear6;
        Softplus<float> softplus7;
        Linear<float> linear8;
    }; // class
} // namespace cunet